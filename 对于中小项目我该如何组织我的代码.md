title: 对于中小项目我该如何组织我的代码
date: 2014-11-14 19:19:11
tags: 代码组织
---

从三个角度来分析

1. 我需要什么（need）
2. 我为什么需要这些（why this）
3. 我能做些什么（what can）

在这里讨论的一个命题是为了一个不大不小的项目来组织一套可以应用的移动开发流程，能否达到预期的目标，能否使用于中小公司，以及业务不是企业级复杂的逻辑。对于现在越来越工程化的前端体系，组织好它，我可能需要很多额外的工具，来辅助我效率的开发。

<!--more-->
**移动开发H5版实例**

##命题1：我需要什么

我罗列了一部分我能思考到的东西，从如下几个地方来分析：

1. 我需要一套标准化的UI
2. 我需要模块化加载来实现对代码模块级别的控制
3. 我需要对代码风格，以及层级的划分
4. 我需要对文件操作的自动化
5. 我需要模板引擎
6. 我需要工具库
7. 我需要消除浏览器兼容的选择器，事件系统，ajax，以及动画系统。

是的，如上七个方向，看看，原来我需要这么些东西，来构建一个移动H5的应用。

##命题2：我为什么需要这些

从上述的七个方向，构成了我基于它的分析，从而来构建自己的应用。但是它仍然抽象，不好理解。比如一套标准的UI，那么什么才是标准？又比如代码风格，以及层级的划分，那么什么样的代码风格和层级划分才比较适合呢？这个命题的讨论，就是把上述的分析方向具体到某些工具的选择，以及实现。

1. 标准化的UI，这里选择的是ratchet，做为bootstrap原班人马对移动H5的重新实现，它还是值得信赖的。利用它，节省了大量的UI实现以及风格命名，如果需要无法实现，可以在它的基础上来修正视觉，以及利用它的结构，来重新书写UI。虽然它不是标准，但是大量的设计，有参考的价值。
2. 对于模块化加载器的选择，我更倾向于require.js，浏览器的开发，模块有意义，但是生产分离这么多模块就没有意义了。相比seajs，require.js更加的熟悉，以及它打包工具的使用。
3. 代码风格的作用，是为了给今后的伙伴或者未来的日子，自己查看阅读使用的。好的风格，在修改bug时，心情可以愉悦。如果几个风格凑合在一起的代码，我想想都比较纠结。所以说到代码风格，又不能不提到层级的划分，以及整个应用业务逻辑实现的规划。你想使用哪些？MVC？MVP？MVVM？这些都有个综合考虑，有些业务场景，也许比较适合MVC，而又有些业务场景又比较适合MVVM，不是说谁比谁更先进，而是谁比谁更适合你的业务。在这里，我选择使用的是MVP。一个非常小巧的库来构建分层系统与代码风格：riot.js。[什么是MVP](http://www.oschina.net/translate/riotjs-the-1kb-mvp-framework)
4. 自动化的意义，是在于帮助开发者解决琐碎的事情，例如文件的压缩，开发时的静态资源，代码检查，自动重启服务器与清楚缓存等等，现在市面上，有几个关于构建自动化任务的工具，相比之下，这里选择了一个比较稳定而且大众的工具：grunt。
5. 模板的出现，可以最大限度的复用结构。移动端H5的开发，需要关注渲染的速度，于是这里我选择一款比较小众但是性能非常不错的模板引擎artTemplate，它书写的风格比较类似于Python模板的风格，它甚至可以把一个模板分拆为几个子模板，最大程度的复用。 
6. 工具类的选择，市面上有几个比较流行的工具库，如underscore。这里的选择，可以把常用的模块抽取出来，并组织进统一的顶层空间中。另外，有些朋友收集了一些，可以替代underscore的工具库，也可以抽取部分，如Lo-Dash。[lodash DOC](http://lodash.com/docs)
7. 最后我们要消除处理DOM时的兼容，我选择的是zepto，它有15个模块，而常用的模块，我们可以抽取出来。比如选择器引擎，AJAX，事件系统。当然动画系统，我认为，可以利用css3实现一个自己的小helper，它可以更加的小巧，而且可以利用硬件加速来保证流畅度。

##命题3：我能做些什么

当我们把上述七个方向的东西，整合成一套体系时，能做的事情，可以根据你的想象，而无限扩大。
